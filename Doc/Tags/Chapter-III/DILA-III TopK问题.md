# Dive Into LeetCodeâ€™s Algorithm

<div align="center">
  <img src="https://raw.githubusercontent.com/JackFroster/Images/main/image/Screenshot%202023-11-17%20at%2013.04.48.png" alt="Screenshot 2023-11-17 at 13.04.48" width = "200px" align= "center"/>
</div>

> å¼•è¨€
>
> æ­¤ NoteBook For LeetCode (Version 1) è®°å½•äº†LeetCodeç®—æ³•é¢˜è§£ï¼ŒåŒ…æ‹¬**çº¿æ®µæ ‘ã€æ ‘çŠ¶æ•°ç»„ã€æ•°å­¦ã€å“ˆå¸Œè®¡æ•°ã€æ¨¡æ‹Ÿã€åŒæŒ‡é’ˆã€å­—ç¬¦ä¸²ã€æ‹“æ‰‘æ’åºã€æ’åºã€æŸ¥æ‰¾ã€æ ‘ã€å‰ç¼€å’Œä¸åç¼€å’Œã€åŠ¨æ€è§„åˆ’ï¼ˆçº¿æ€§DP,æ ‘å½¢DP,çŠ¶æ€å‹ç¼©DP,æ•°ä½DP,çŠ¶æ€æœºDPï¼‰ã€æœ€çŸ­è·¯ã€æ•°è®ºã€è´ªå¿ƒã€Tireæ ‘ã€é€’å½’ä¸å›æº¯ã€é“¾è¡¨ã€æšä¸¾ã€è¿›åˆ¶è½¬æ¢ã€å•è°ƒæ ˆã€BFSã€DFSã€å¹¶æŸ¥é›†ã€Topké—®é¢˜ã€æœ€å¤§æœ€å°é—®é¢˜ã€æœ€å°æœ€å¤§é—®é¢˜ã€æ»‘åŠ¨çª—å£ç®—æ³•ã€äºŒåˆ†ã€ç¨€ç–è¡¨ã€Tarjan ç®—æ³•ã€FloodFillã€Kadane's algorithmã€KMPã€æ‰«æçº¿**ç­‰ã€‚
>
> :man:ï¼š`Jackson Dean`	:timer_clock: ï¼š`2022-02-04`  :pencil2:ï¼š`c/c++/java/python`  :gear:ï¼š[`Github`](https://github.com/JackFroster/JF-Notes)  :information_source:: [`LeetCode`](https://leetcode.cn/)  





# ç¬¬ä¸‰éƒ¨åˆ†ä¹‹TopKé—®é¢˜



### 1ã€TopK+å¤šè·¯å½’å¹¶/å †/äºŒåˆ†/åŒæŒ‡é’ˆ

#### ï¼ˆ1ï¼‰[378. æœ‰åºçŸ©é˜µä¸­ç¬¬ K å°çš„å…ƒç´ ](https://leetcode.cn/problems/kth-smallest-element-in-a-sorted-matrix/)ï¼ˆå¤šè·¯å½’å¹¶ï¼‰

**é—®é¢˜**ï¼š

ç»™ä½ ä¸€ä¸ª `n x n` çŸ©é˜µ `matrix` ï¼Œå…¶ä¸­æ¯è¡Œå’Œæ¯åˆ—å…ƒç´ å‡æŒ‰å‡åºæ’åºï¼Œæ‰¾åˆ°çŸ©é˜µä¸­ç¬¬ `k` å°çš„å…ƒç´ ã€‚

è¯·æ³¨æ„ï¼Œå®ƒæ˜¯ **æ’åºå** çš„ç¬¬ `k` å°å…ƒç´ ï¼Œè€Œä¸æ˜¯ç¬¬ `k` ä¸ª **ä¸åŒ** çš„å…ƒç´ ã€‚

ä½ å¿…é¡»æ‰¾åˆ°ä¸€ä¸ªå†…å­˜å¤æ‚åº¦ä¼˜äº `O(n^2)` çš„è§£å†³æ–¹æ¡ˆã€‚

ä¾‹å­ï¼š

```
è¾“å…¥ï¼šmatrix = [[1,5,9],[10,11,13],[12,13,15]], k = 8
è¾“å‡ºï¼š13
è§£é‡Šï¼šçŸ©é˜µä¸­çš„å…ƒç´ ä¸º [1,5,9,10,11,12,13,13,15]ï¼Œç¬¬ 8 å°å…ƒç´ æ˜¯ 13
```

**æ•°æ®èŒƒå›´**ï¼š

- `n == matrix.length`
- `n == matrix[i].length`
- `1 <= n <= 300`
- `-10^9 <= matrix[i][j] <= 10^9`
- é¢˜ç›®æ•°æ® **ä¿è¯** `matrix` ä¸­çš„æ‰€æœ‰è¡Œå’Œåˆ—éƒ½æŒ‰ **éé€’å‡é¡ºåº** æ’åˆ—
- `1 <= k <= n^2`

**æ€è·¯**ï¼š

å¤šè·¯å½’å¹¶ï¼šæ ¸å¿ƒæ€æƒ³æ˜¯é‡‡ç”¨åˆ†æ²»ï¼Œå°†å¤šè·¯å½’å¹¶è½¬æ¢ä¸ºäºŒè·¯å½’å¹¶ã€‚æ—¶é—´å¤æ‚åº¦æ˜¯ $O(nlogn)$

- é‡‡ç”¨å½’å¹¶æ’åºä¸­çš„åˆ†æ²»æ€æƒ³ï¼Œå°†$n$ä¸ªæœ‰åºåºåˆ—åˆ†æˆä¸¤ä»½åºåˆ—ã€‚
- å¯¹å·¦å³ä¸¤ä»½åºåˆ—è¿›è¡Œé€’å½’çš„åˆ’åˆ†ï¼Œç›´åˆ°æ¯ä¸€ä»½ä¸­åªæœ‰ä¸€ä¸ªåºåˆ—ã€‚
- å°†å·¦å³ä¸¤ä¸ªä»»åŠ¡ç»“æœè¿›è¡ŒäºŒè·¯å½’å¹¶

```java
class Solution {
    // nlogn
    public int[] merger(int[][] matrix, int l, int r) {
        if(l >= r) return matrix[l];

        int mid = l + r >> 1;
        int[] a = merger(matrix, l, mid), b = merger(matrix, mid + 1, r);

        int n = a.length, m = b.length;
        int[] temp = new int[n + m];
        int i = 0, j = 0, k = 0;
        
        while(i < n && j < m) {
            if(a[i] < b[j]) temp[k ++] = a[i ++];
            else temp[k ++] = b[j ++];
        }
        while(i < n) temp[k ++] = a[i ++];
        while(j < m) temp[k ++] = b[j ++];

        return temp;
    }   

    public int kthSmallest(int[][] matrix, int k) {
        int[] arr = merger(matrix, 0, matrix.length - 1);
        return arr[k - 1];
    }
}
```

ä½ èƒ½å¦ç”¨ä¸€ä¸ªæ’å®šçš„å†…å­˜(å³ $O(1)$ å†…å­˜å¤æ‚åº¦)æ¥è§£å†³è¿™ä¸ªé—®é¢˜?
ä½ èƒ½åœ¨ $O(n)$ çš„æ—¶é—´å¤æ‚åº¦ä¸‹è§£å†³è¿™ä¸ªé—®é¢˜å—?è¿™ä¸ªæ–¹æ³•å¯¹äºé¢è¯•æ¥è¯´å¯èƒ½å¤ªè¶…å‰äº†ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼ˆ [this paper](http://www.cse.yorku.ca/~andy/pubs/X+Y.pdf) ï¼‰å¾ˆæœ‰è¶£ã€‚

#### ï¼ˆ2ï¼‰[373. æŸ¥æ‰¾å’Œæœ€å°çš„ K å¯¹æ•°å­—](https://leetcode.cn/problems/find-k-pairs-with-smallest-sums/) (åŠ æ³•ï¼ŒäºŒç»´ï¼Œå †)

**é—®é¢˜**ï¼š

ç»™å®šä¸¤ä¸ªä»¥ **å‡åºæ’åˆ—** çš„æ•´æ•°æ•°ç»„ `nums1` å’Œ `nums2` , ä»¥åŠä¸€ä¸ªæ•´æ•° `k` ã€‚

å®šä¹‰ä¸€å¯¹å€¼ `(u,v)`ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ¥è‡ª `nums1`ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ¥è‡ª `nums2` ã€‚

è¯·æ‰¾åˆ°å’Œæœ€å°çš„ `k` ä¸ªæ•°å¯¹ `(u1,v1)`, ` (u2,v2)` ...  `(uk,vk)` ã€‚

ä¾‹å­ï¼š

```
è¾“å…¥: nums1 = [1,7,11], nums2 = [2,4,6], k = 3
è¾“å‡º: [1,2],[1,4],[1,6]
è§£é‡Š: è¿”å›åºåˆ—ä¸­çš„å‰ 3 å¯¹æ•°ï¼š
     [1,2],[1,4],[1,6],[7,2],[7,4],[11,2],[7,6],[11,4],[11,6]
```

**æ•°æ®èŒƒå›´**ï¼š

- `1 <= nums1.length, nums2.length <= 10^5`

- `-10^9 <= nums1[i], nums2[i] <= 10^9`
- `nums1` å’Œ `nums2` å‡ä¸ºå‡åºæ’åˆ—
- `1 <= k <= 1000`

**æ€è·¯**ï¼š[è®²æ¸…æ¥šä¸ºä»€ä¹ˆä¸€å¼€å§‹è¦æŠŠ (i,0) éƒ½å…¥å †ï¼]([è®²æ¸…æ¥šä¸ºä»€ä¹ˆä¸€å¼€å§‹è¦æŠŠ (i,0) éƒ½å…¥å †ï¼é™„é¢˜å•ï¼ - æŸ¥æ‰¾å’Œæœ€å°çš„ K å¯¹æ•°å­— - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/find-k-pairs-with-smallest-sums/solution/jiang-qing-chu-wei-shi-yao-yi-kai-shi-ya-i0dj/)) 

åˆæ­¥æ€è·¯ï¼š

<img src="/Users/yjzhai/Library/Application Support/typora-user-images/æˆªå±2023-05-28 20.56.11.png" alt="æˆªå±2023-05-28 20.56.11" style="zoom:50%;" />

ä¸€ä¸ªå¤æ‚çš„ç®—æ³•ï¼š

<img src="/Users/yjzhai/Library/Application Support/typora-user-images/æˆªå±2023-05-28 20.58.41.png" alt="æˆªå±2023-05-28 20.58.41" style="zoom:50%;" />

![å­¦ç”Ÿç™»å½•ç”¨ä¾‹å›¾ (10).png](https://pic.leetcode-cn.com/1642133430-NIIiwX-%E5%AD%A6%E7%94%9F%E7%99%BB%E5%BD%95%E7%94%A8%E4%BE%8B%E5%9B%BE%20(10).png)

ä¸Šå›¾ä¸­çš„ï¼ˆi,jï¼‰è¡¨ç¤ºçš„æ˜¯nums1ä¸‹æ ‡iä¸nums2ä¸‹æ ‡jï¼Œç®­å¤´è¡¨ç¤ºçš„æ˜¯è‹¥é€‰æ‹©æ•°å¯¹ï¼ˆi,jï¼‰ï¼Œé‚£ä¹ˆå°±éœ€è¦æŠŠæ•°å¯¹ï¼ˆi,j+1ï¼‰ä¸ï¼ˆi+1,jï¼‰åŠ å…¥åˆ°å€™é€‰ä¸­ã€‚
ç”±å›¾å¯ä»¥å‘ç°ï¼Œè‹¥ï¼ˆ0,1ï¼‰å’Œï¼ˆ1,0ï¼‰å‡è¢«é€‰è¿‡ï¼Œé‚£ä¹ˆï¼ˆ1,1ï¼‰æ•°å¯¹å°±ä¼šåœ¨å€™é€‰ä¸­å‡ºç°2æ¬¡ï¼Œä¹Ÿå°±æ˜¯é€ æˆäº†é‡å¤ã€‚

```java
class Solution {

    public List<List<Integer>> kSmallestPairs(int[] nums1, int[] nums2, int k) {
        
        int n = nums1.length, m = nums2.length;
        HashMap<List<Integer>, Boolean> map = new HashMap<>(); // åˆ¤é‡
        List<List<Integer>> list = new ArrayList<>(); // å­˜å‚¨ç»“æœ

        PriorityQueue<List<Integer>> heap = new PriorityQueue<>((a, b) -> { // å°æ ¹å †
            return a.get(2) + a.get(3) - (b.get(2) + b.get(3));
        });

        heap.offer(Arrays.asList(new Integer[]{0, 0, nums1[0], nums2[0]})); // åˆå§‹åŒ–å°æ ¹å †
        map.put(Arrays.asList(new Integer[]{0, 0, nums2[0], nums2[0]}), true); // åˆå§‹åŒ–map

        while(list.size() < k && heap.size() != 0) { // å–å‡ºæœ€å°çš„kå¯¹æ•°å­—
            List<Integer> pair = heap.poll();
            int x = pair.get(0), y = pair.get(1);

            list.add(Arrays.asList(new Integer[]{nums1[x], nums2[y]}));

            List<Integer> a = null, b = null; // æ¯”(x, y) å¤§çš„æ•°å­—å¯¹æœ‰(x + 1, y)å’Œ(x, y + 1)
            if(x + 1 < n && y < m) a = Arrays.asList(new Integer[]{x + 1, y, nums1[x + 1], nums2[y]}); // åˆ¤æ–­ä¸èƒ½æ•°ç»„è¶Šç•Œ
            if(x  < n && y + 1 < m) b = Arrays.asList(new Integer[]{x, y + 1, nums1[x], nums2[y + 1]});

            if(a != null && map.get(a) == null) { // åˆ¤é‡
                heap.offer(a);
                map.put(a, true);
            }
            if(b != null && map.get(b) == null) {
                heap.offer(b);
                map.put(b, true);
            }
        }

        return list;
    }
}
// (0, 0) -> (1, 0), (0, 1)
// (i, j) ->(i + 1, j), (i, j + 1)
// (1, 0) - > (1, 1), (2, 0)
// (0, 1) - > (1, 1), (2, 0)
```

ä¼˜åŒ–åçš„ç®—æ³•ï¼š 

<img src="/Users/yjzhai/Library/Application Support/typora-user-images/æˆªå±2023-05-28 21.00.14.png" alt="æˆªå±2023-05-28 21.00.14" style="zoom:50%;" />

é‚£ä¹ˆå¦‚ä½•è§£å†³é‡å¤é—®é¢˜å‘¢ï¼Ÿ
ï¼ˆ0,1ï¼‰æ•°å¯¹å€¼>=ï¼ˆ1,1ï¼‰æ•°å¯¹å€¼
ï¼ˆ1,0ï¼‰æ•°å¯¹å€¼>=ï¼ˆ1,1ï¼‰æ•°å¯¹å€¼
è¿™è¯´æ˜äº†å½“ï¼ˆ1,1ï¼‰ä½œä¸ºç­”æ¡ˆå‰ï¼Œï¼ˆ0,1ï¼‰ä¸ï¼ˆ1,0ï¼‰å‡å·²è¢«ä½œä¸ºç­”æ¡ˆã€‚
é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦ä¿ç•™ï¼ˆ0,1ï¼‰->ï¼ˆ1,1ï¼‰ä¸ï¼ˆ1,0ï¼‰->ï¼ˆ1,1ï¼‰å…¶ä¸­ä¸€ä¸ªç®­å¤´å³å¯ã€‚

<img src="https://pic.leetcode-cn.com/1642134228-zyNpBD-image.png" alt="image.png" style="zoom: 67%;" />

æ—¶é—´å¤æ‚åº¦æ˜¯ $O(klogkï¼‰$ 

```java
class Solution {

    public List<List<Integer>> getTopk(int[] a, int[] b, int k) {
        int n = a.length, m = b.length;

        List<List<Integer>> topk = new ArrayList<>(); // å­˜å‚¨ç»“æœ
        PriorityQueue<int[]> heap = new PriorityQueue<>((x, y) -> x[2] - y[2]);
        for(int i = 0; i < n; i ++ ) heap.offer(new int[]{i, 0, a[i] + b[0]});

        for(int i = 0; i < k && heap.size() != 0; i ++) {
            int[] t = heap.poll();
            int tx = t[0], ty = t[1];
            topk.add(Arrays.asList(new Integer[]{a[tx], b[ty]}));

            if(tx < n && ty + 1 < m) heap.offer(new int[]{ tx, ty + 1, a[tx] + b[ty + 1]});
        }
        return topk;
    }

    public List<List<Integer>> kSmallestPairs(int[] nums1, int[] nums2, int k) {
        return getTopk(nums1, nums2, k);
    }
}
```

#### ï¼ˆ3ï¼‰[1439. æœ‰åºçŸ©é˜µä¸­çš„ç¬¬ k ä¸ªæœ€å°æ•°ç»„å’Œ](https://leetcode.cn/problems/find-the-kth-smallest-sum-of-a-matrix-with-sorted-rows/)ï¼ˆåŠ æ³•ï¼Œå¤šç»´ï¼Œåˆ†æ²»+å †ï¼‰

**é—®é¢˜**ï¼š

ç»™ä½ ä¸€ä¸ª `m * n` çš„çŸ©é˜µ `mat`ï¼Œä»¥åŠä¸€ä¸ªæ•´æ•° `k` ï¼ŒçŸ©é˜µä¸­çš„æ¯ä¸€è¡Œéƒ½ä»¥éé€’å‡çš„é¡ºåºæ’åˆ—ã€‚ä½ å¯ä»¥ä»æ¯ä¸€è¡Œä¸­é€‰å‡º 1 ä¸ªå…ƒç´ å½¢æˆä¸€ä¸ªæ•°ç»„ã€‚è¿”å›æ‰€æœ‰å¯èƒ½æ•°ç»„ä¸­çš„ç¬¬ k ä¸ª **æœ€å°** æ•°ç»„å’Œã€‚

ä¾‹å­ï¼š

```
è¾“å…¥ï¼šmat = [[1,3,11],[2,4,6]], k = 5
è¾“å‡ºï¼š7
è§£é‡Šï¼šä»æ¯ä¸€è¡Œä¸­é€‰å‡ºä¸€ä¸ªå…ƒç´ ï¼Œå‰ k ä¸ªå’Œæœ€å°çš„æ•°ç»„åˆ†åˆ«æ˜¯ï¼š
[1,2], [1,4], [3,2], [3,4], [1,6]ã€‚å…¶ä¸­ç¬¬ 5 ä¸ªçš„å’Œæ˜¯ 7 ã€‚
```

**æ•°æ®èŒƒå›´**ï¼š

- `m == mat.length`
- `n == mat.length[i]`
- `1 <= m, n <= 40`
- `1 <= k <= min(200, n ^ m)`
- `1 <= mat[i][j] <= 5000`
- `mat[i]` æ˜¯ä¸€ä¸ªéé€’å‡æ•°ç»„

**æ€è·¯**ï¼š

æœ´ç´ ç®—æ³•ï¼šå † + å“ˆå¸Œè¡¨

ä¸[373. æŸ¥æ‰¾å’Œæœ€å°çš„ K å¯¹æ•°å­—](https://leetcode.cn/problems/find-k-pairs-with-smallest-sums/)çš„æ±‚è§£æ€è·¯ä¸€è‡´ï¼Œåªä¸è¿‡æ‰©å±•æˆæˆå¤šä¸ªç»´åº¦

```java
class Solution {
    public int kthSmallest(int[][] mat, int k) {
        int n = mat.length, m = mat[0].length;
        
        List<Integer> res = new ArrayList<>();
        HashMap<List<Integer>, Boolean> map = new HashMap<>();
        PriorityQueue<List<Integer>> heap = new PriorityQueue<>((a, b) -> a.get(a.size()-1) - b.get(b.size()-1));

        int sum = 0;
        List<Integer> arr = new ArrayList<>();
        for(int i = 0; i < n; i ++) {
            sum += mat[i][0];
            arr.add(0);
        }
        arr.add(sum);
        map.put(arr, true);
        heap.offer(arr);

        while(res.size() < k) {
            List<Integer> t = heap.poll();
            res.add(t.get(t.size() - 1));

            for(int i = 0; i < n; i ++ ) {
                List<Integer> list = new ArrayList<>(t);
                int a = list.get(i), s = list.get(list.size() - 1);
                
                if(a + 1 >= m) continue;
                list.set(i, a + 1);
                list.set(list.size() - 1, s - mat[i][a] + mat[i][a + 1]);

                if(map.get(list) == null) {
                    heap.offer(list);
                    map.put(list, true);
                }
            }
        }
        return res.get(res.size() - 1);
    }
}
```

ä¼˜åŒ–åçš„ç®—æ³•ï¼šåˆ†æ²»+å †

[378. æœ‰åºçŸ©é˜µä¸­ç¬¬ K å°çš„å…ƒç´ ](https://leetcode.cn/problems/kth-smallest-element-in-a-sorted-matrix/) å’Œ [373. æŸ¥æ‰¾å’Œæœ€å°çš„ K å¯¹æ•°å­—](https://leetcode.cn/problems/find-k-pairs-with-smallest-sums/) ä¸¤è€…æ€æƒ³çš„ç»“åˆ

æ—¶é—´å¤æ‚åº¦æ˜¯ $O(k \times logk \times n)$å…¶ä¸­ $n$ æ˜¯ $mat$ çŸ©é˜µçš„è¡Œæ•°ã€‚

```java
class Solution {

    public int[] getTopk(int[] a, int[] b, int k) {
        int n = a.length, m = b.length;

        PriorityQueue<int[]> heap = new PriorityQueue<>((x, y) -> x[2] - y[2]);
        for(int i = 0; i < n; i ++ ) heap.offer(new int[]{i, 0, a[i] + b[0]});

        int[] topk = new int[k];
        int len = 0;
        for(int i = 0; i < k && heap.size() != 0; i ++) {
            int[] t = heap.poll();
            int tx = t[0], ty = t[1];
            topk[i] = t[2];
            len ++ ;
            if(tx < n && ty + 1 < m) heap.offer(new int[]{ tx, ty + 1, a[tx] + b[ty + 1]});
        }
        return Arrays.copyOf(topk, len);
    }

    public int kthSmallest(int[][] mat, int k) {
        int[] topk = mat[0];
        for(int i = 1; i < mat.length; i ++ ) 
            topk = getTopk(topk, mat[i], k);
        return topk[k - 1];
    }
}
```

#### ï¼ˆ4ï¼‰[786. ç¬¬ K ä¸ªæœ€å°çš„ç´ æ•°åˆ†æ•°](https://leetcode-cn.com/problems/k-th-smallest-prime-fraction/)ï¼ˆé™¤æ³•ï¼Œå †ï¼‰

**é—®é¢˜**ï¼š

ç»™ä½ ä¸€ä¸ª**æŒ‰é€’å¢é¡ºåºæ’åº**çš„æ•°ç»„ `arr` å’Œä¸€ä¸ªæ•´æ•° `k` ã€‚æ•°ç»„ `arr` ç”± `1` å’Œè‹¥å¹² **ç´ æ•°** ç»„æˆï¼Œä¸”å…¶ä¸­æ‰€æœ‰æ•´æ•°äº’ä¸ç›¸åŒã€‚

å¯¹äºæ¯å¯¹æ»¡è¶³ `0 <= i < j < arr.length` çš„ `i` å’Œ `j` ï¼Œå¯ä»¥å¾—åˆ°åˆ†æ•° `arr[i] / arr[j]` ã€‚

é‚£ä¹ˆç¬¬ `k` ä¸ªæœ€å°çš„åˆ†æ•°æ˜¯å¤šå°‘å‘¢? ä»¥é•¿åº¦ä¸º `2` çš„æ•´æ•°æ•°ç»„è¿”å›ä½ çš„ç­”æ¡ˆ, è¿™é‡Œ `answer[0] == arr[i]` ä¸” `answer[1] == arr[j]` ã€‚

ä¾‹å­ï¼š

```java
è¾“å…¥ï¼šarr = [1,2,3,5], k = 3
è¾“å‡ºï¼š[2,5]
è§£é‡Šï¼šå·²æ„é€ å¥½çš„åˆ†æ•°,æ’åºåå¦‚ä¸‹æ‰€ç¤º: 
1/5, 1/3, 2/5, 1/2, 3/5, 2/3
å¾ˆæ˜æ˜¾ç¬¬ä¸‰ä¸ªæœ€å°çš„åˆ†æ•°æ˜¯ 2/5
```

**æ•°æ®èŒƒå›´**ï¼š

- `2 <= arr.length <= 1000`
- `1 <= arr[i] <= 3 * 104`
- `arr[0] == 1`
- `arr[i]` æ˜¯ä¸€ä¸ª **ç´ æ•°** ï¼Œ`i > 0`
- `arr` ä¸­çš„æ‰€æœ‰æ•°å­— **äº’ä¸ç›¸åŒ** ï¼Œä¸”æŒ‰ **ä¸¥æ ¼é€’å¢** æ’åº
- `1 <= k <= arr.length * (arr.length - 1) / 2`

**æ€è·¯**ï¼šä¸ 373. æŸ¥æ‰¾å’Œæœ€å°çš„ K å¯¹æ•°å­— çš„æ€æƒ³ä¸€è‡´

æœ´ç´ ç®—æ³•ï¼šå †+å“ˆå¸Œè¡¨

æ—¶é—´å¤æ‚åº¦æ˜¯ $O(klogk)$

```java
class Solution {
    public int[] kthSmallestPrimeFraction(int[] arr, int k) {
        int n = arr.length;
        PriorityQueue<double[]> heap = new PriorityQueue<>((a, b) -> (int)Math.signum(a[2] - b[2]));
        boolean st[][] = new boolean[n][n]; // åˆ¤é‡

        heap.offer(new double[]{0, n - 1, (double)arr[0]/arr[n - 1]});
        st[0][n - 1] = true;

        List<int[]> topk = new ArrayList<>();
        while(topk.size() < k) {
            double[] t = heap.poll();
            int tx = (int)t[0], ty = (int)t[1];
            topk.add(new int[]{arr[tx], arr[ty]});

            if(tx + 1 < ty && !st[tx + 1][ty]) {
                heap.offer(new double[]{tx + 1, ty, (double)arr[tx + 1]/arr[ty]});
                st[tx + 1][ty] = true;
            }
            if(tx < ty - 1 && !st[tx][ty - 1]) {
                heap.offer(new double[]{tx, ty - 1, (double)arr[tx]/arr[ty - 1]});
                st[tx][ty - 1] = true;
            }
        }
        return topk.get(k - 1);
    }
}
```

ä¼˜åŒ–åçš„ç®—æ³•ï¼šå †

æ•°ç»„ $arr$ æ˜¯ä¸€ä¸ª**æŒ‰é€’å¢é¡ºåºæ’åº**çš„æ•°ç»„ã€‚é‚£ä¹ˆæœ€å°çš„åˆ†æ•°ä¸€å®šæ˜¯ $arr[0]/arr[n - 1]$ï¼Œ$n$ æ˜¯æ•°ç»„çš„é•¿åº¦ã€‚æˆ‘ä»¬é‡‡ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ¥ç»´æŠ¤å½“å‰çš„æœ€å°çš„åˆ†æ•°ã€‚æ­£å¦‚ä¸Šé¢æœ´ç´ ç®—æ³•æ‰€ç¤ºï¼Œå½“å…ƒç´ å¯¹ $(i,j)$å‡ºå †æ—¶ï¼Œ$(i+1,j)$å’Œ$(i,j-1)$ä¼šå…¥å †ï¼Œå› ä¸ºè¿™ä¸ªä¸¤ä¸ªå…ƒç´ å¯¹æ˜¯æ¯”$(i,j)$æ¬¡å¤§çš„å…ƒç´ å¯¹ã€‚

ä½†æ˜¯ï¼Œå¯¹äº $[0,1,2,3]$ï¼Œå½“$(1,3)$å‡ºå †æ—¶ï¼Œ$(1,2)$ä¼šå…¥å †ã€‚å½“$(0,2)$å‡ºå †æ—¶ï¼Œ$(1,2)$ä¹Ÿä¼šå…¥å †ã€‚ç”±äº**å­˜åœ¨é‡å¤å…ƒç´ **å¯¹ï¼Œæœ´ç´ ç®—æ³•é‡‡ç”¨äº†`HashMap`æ¥åˆ¤é‡ã€‚

ä½¿ç”¨é¢å¤–`HashMap`æ¥åˆ¤é‡ï¼Œæ— ç–‘å¢å¤§äº†å†…å­˜æ¶ˆè€—ã€‚æœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥é™ä½å†…å­˜å ç”¨ã€‚

ä¸ä¹‹å‰**373. æŸ¥æ‰¾å’Œæœ€å°çš„ K å¯¹æ•°å­—**çš„åšæ³•ä¸€è‡´ï¼Œæˆ‘ä»¬é¢„å…ˆå°† $(i,n-1),i=0,...,n-2$å…ƒç´ å¯¹å…¥å †ã€‚ç„¶åï¼Œå½“$(i,j)$å‡ºå †æ—¶åªæ‰§è¡Œ$(i,j-1)$å…¥å †æ“ä½œã€‚

æ—¶é—´å¤æ‚åº¦æ˜¯ $O(klogk)$

```java
class Solution {
    public int[] kthSmallestPrimeFraction(int[] arr, int k) {
        int n = arr.length;
        PriorityQueue<double[]> heap = new PriorityQueue<>((a, b) -> (int)Math.signum(a[2] - b[2]));

        for(int i = 0; i < n - 1; i ++)
            heap.offer(new double[]{i, n - 1, (double)arr[i]/arr[n - 1]});

        List<int[]> topk = new ArrayList<>();
        while(topk.size() < k) {
            double[] t = heap.poll();
            int tx = (int)t[0], ty = (int)t[1];
            topk.add(new int[]{arr[tx], arr[ty]});

            if(tx < ty - 1) heap.offer(new double[]{tx, ty - 1, (double)arr[tx]/arr[ty - 1]});
        }
        return topk.get(k - 1);
    }
}
```

#### ï¼ˆ5ï¼‰[719. æ‰¾å‡ºç¬¬ k å°çš„è·ç¦»å¯¹](https://leetcode-cn.com/problems/find-k-th-smallest-pair-distance/)ï¼ˆå‡æ³•ï¼Œæ•°æ®èŒƒå›´å¤§ï¼ŒäºŒåˆ†åµŒå¥—äºŒåˆ†/åŒæŒ‡é’ˆï¼‰

**é—®é¢˜**ï¼š

æ•°å¯¹ `(a,b)` ç”±æ•´æ•° `a` å’Œ `b` ç»„æˆï¼Œå…¶æ•°å¯¹è·ç¦»å®šä¹‰ä¸º `a` å’Œ `b` çš„ç»å¯¹å·®å€¼ã€‚ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ•´æ•° `k` ï¼Œæ•°å¯¹ç”± `nums[i]` å’Œ `nums[j]` ç»„æˆä¸”æ»¡è¶³ `0 <= i < j < nums.length` ã€‚è¿”å› **æ‰€æœ‰æ•°å¯¹è·ç¦»ä¸­** ç¬¬ `k` å°çš„æ•°å¯¹è·ç¦»ã€‚

ä¾‹å­ï¼š

```java
è¾“å…¥ï¼šnums = [1,3,1], k = 1
è¾“å‡ºï¼š0
è§£é‡Šï¼šæ•°å¯¹å’Œå¯¹åº”çš„è·ç¦»å¦‚ä¸‹ï¼š
(1,3) -> 2
(1,1) -> 0
(3,1) -> 2
è·ç¦»ç¬¬ 1 å°çš„æ•°å¯¹æ˜¯ (1,1) ï¼Œè·ç¦»ä¸º 0 ã€‚
```

**æ•°æ®èŒƒå›´**ï¼š

- `n == nums.length`
- `2 <= n <= 10^4`
- `0 <= nums[i] <= 10^6`
- `1 <= k <= n * (n - 1) / 2`

**æ€è·¯**ï¼š

**æ–¹æ³•ä¸€ï¼šå †**

æˆ‘ä»¬é¦–å…ˆå°†$nums$æ•°ç»„ä»å°åˆ°å¤§æ’åºï¼Œè¿™æ · $nums$ æ˜¯ä¸€ä¸ªæŒ‰é€’å¢é¡ºåºæ’åºçš„æ•°ç»„ã€‚é‚£ä¹ˆæœ€å°çš„**è·ç¦»å¯¹**ä¸€å®šæ˜¯ $|arr[0]-arr[1]|$ï¼Œè®¾$n$ æ˜¯æ•°ç»„çš„é•¿åº¦ã€‚æˆ‘ä»¬é‡‡ç”¨**ä¼˜å…ˆé˜Ÿåˆ—**æ¥ç»´æŠ¤å½“å‰çš„æœ€å°çš„è·ç¦»å¯¹ã€‚å½“å…ƒç´ å¯¹ $(i,j), i<jä¸”iâ‰ j$å‡ºå †æ—¶ï¼Œè®©$(i+1,j+1)$å’Œ$(i,j+1)$ä¼šå…¥å †ï¼Œå› ä¸ºè¿™ä¸ªä¸¤ä¸ªå…ƒç´ å¯¹æ˜¯æ¯”$(i,j)$**æ¬¡å¤§çš„è·ç¦»å¯¹**ã€‚

ä½†æ˜¯ï¼Œå¯¹äº $[0,1,2,3]$ï¼Œå½“$(1,2)$å‡ºå †æ—¶ï¼Œ$(1,3)$ä¼šå…¥å †ã€‚å½“$(0,2)$å‡ºå †æ—¶ï¼Œ$(1,3)$ä¹Ÿä¼šå…¥å †ã€‚ç”±äºå­˜åœ¨é‡å¤å…ƒç´ å¯¹ï¼Œ**æœ´ç´ ç®—æ³•**å¯ä»¥é‡‡ç”¨äº†`HashMap`æ¥åˆ¤é‡ã€‚

ä½¿ç”¨é¢å¤–`HashMap`æ¥åˆ¤é‡ï¼Œæ— ç–‘å¢å¤§äº†å†…å­˜æ¶ˆè€—ã€‚æœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥é™ä½å†…å­˜å ç”¨ã€‚

ä¸ä¹‹å‰**373. æŸ¥æ‰¾å’Œæœ€å°çš„ K å¯¹æ•°å­—**çš„åšæ³•ä¸€è‡´ï¼Œæˆ‘ä»¬é¢„å…ˆå°† $(i,i+1),i=0,...,n-2$å…ƒç´ å¯¹å…¥å †ã€‚ç„¶åï¼Œå½“$(i,j)$å‡ºå †æ—¶**åªæ‰§è¡Œ**$(i,j+1)$å…¥å †æ“ä½œã€‚

ä¼˜åŒ–åçš„ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(klogk)$ï¼Œ**è€ƒè™‘åˆ°æ•°æ®èŒƒå›´éå¸¸å¤§**ï¼Œ$k=10^8$ï¼Œæ—¶ä¸‹é¢çš„ç®—æ³•ä¾ç„¶ä¼šè¶…æ—¶å’Œè¶…å‡ºå†…å­˜é™åˆ¶ã€‚

```java
class Solution {
    public int smallestDistancePair(int[] nums, int k) {
        int n = nums.length;
        Arrays.sort(nums);

        PriorityQueue<int[]> heap = new PriorityQueue<>((a, b) -> a[2] - b[2]);
        for(int i = 0; i < n - 1; i ++) 
            heap.offer(new int[]{i, i + 1, Math.abs(nums[i] - nums[i + 1])});

        int res = 0;
        while(k > 0 && heap.size() != 0) {
            int[] t = heap.poll();
            int tx = t[0], ty = t[1];
            res = t[2];
            k -- ;

            if(ty + 1 < n) heap.offer(new int[]{tx, ty + 1, Math.abs(nums[tx] - nums[ty + 1])});
        }

        return res;
    }
}
```

ä¸Šè¿°ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸$k$æœ‰å…³ï¼Œè€Œ$k$ä¸æ•°æ®çš„è§„æ¨¡$n$æœ‰å…³ã€‚**æˆ‘ä»¬èƒ½ä¸èƒ½è®¾è®¡ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸$k$æ— å…³çš„ç®—æ³•**ã€‚

**æ–¹æ³•äºŒï¼šæ’åº+äºŒåˆ†æŸ¥æ‰¾+åµŒå¥—äºŒåˆ†æŸ¥æ‰¾**

å…ˆå°†æ•°ç»„ $nums$ ä»å°åˆ°å¤§è¿›è¡Œæ’åºï¼Œé‚£ä¹ˆæ‰€æœ‰æ•°å¯¹ä¸­ç¬¬ $k$ å°çš„æ•°å¯¹è·ç¦»ä¸€å®šå‡ºç°åœ¨åœ¨åŒºé—´$[0,(max(nums)-min(nums))]$ä¸­ã€‚ä»¤$left=0,right=(max(nums)-min(nums))$ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨$[left, right]$åŒºé—´ä¸Šé‡‡ç”¨**äºŒåˆ†æŸ¥æ‰¾**æšä¸¾ç¬¬ $k$ å°çš„æ•°å¯¹è·ç¦»ã€‚

å¯¹äºå½“å‰æœç´¢çš„è·ç¦» $mid$ï¼ŒæŸ¥æ‰¾å°äºç­‰äºè·ç¦» $mid$ çš„æ•°å¯¹çš„ä¸ªæ•° $cnt$ã€‚å¦‚æœ $cnt >= k$ï¼Œä»¤$right = mid - 1$; å¦‚æœ $cnt < k$ï¼Œä»¤$left = mid + 1$ã€‚ç›´åˆ° $left > right$ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ç¬¬$k$å°çš„è·ç¦»$left$ã€‚

é‚£ä¹ˆå¯¹äºç»™å®šä¸€ä¸ªè·ç¦» $mid$ï¼Œ å¦‚ä½•æŸ¥æ‰¾å°äºç­‰äºè·ç¦» $mid$çš„æ•°å¯¹çš„ä¸ªæ•° $cnt$ å‘¢ï¼Ÿ

å¯¹äºæ–¹æ³•äºŒï¼Œæˆ‘ä»¬é‡‡ç”¨åµŒå¥—çš„äºŒåˆ†æŸ¥æ‰¾æ¥è§£å†³ã€‚å¯¹äºæ–¹æ³•ä¸‰ï¼Œæˆ‘ä»¬é‡‡ç”¨åŒæŒ‡é’ˆç®—æ³•æ¥è§£å†³ã€‚

æšä¸¾æ¯ä¸€ä¸ªå³ç«¯ç‚¹$j$ï¼Œåœ¨å·²æ’åºçš„æ•°ç»„$nums$ä¸­ï¼ŒäºŒåˆ†æŸ¥æ‰¾å¤§äº$nums[j]-mid$çš„**æœ€å°**çš„$i$ã€‚é‚£ä¹ˆï¼Œä»¥$j$ ä¸ºå³ç«¯ç‚¹çš„å°äºç­‰äº$mid$è·ç¦»å¯¹çš„ä¸ªæ•°ä¸º$j - i$ã€‚ç»Ÿè®¡æ‰€æœ‰çš„$j-i$ä¹‹å’Œï¼Œå³è·ç¦»å°äºç­‰äº$mid$çš„æ•°å¯¹çš„ä¸ªæ•°$cnt$ã€‚

æ—¶é—´å¤æ‚åº¦åˆ†æï¼šæ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸º$O(nlogn)$ï¼Œè®¾$D=max(nums)-min(nums)$ï¼Œå¤–å±‚äºŒåˆ†çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(logD)$ï¼Œå†…å±‚äºŒåˆ†çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(nlogn)$ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(nlogn+nlogn \times logD)=>O(nlogn \times logD)$

```java
class Solution {
    public int bsearch(int[]nums, int x) { // åœ¨å‡åºæ•°ç»„numsä¸­æŸ¥æ‰¾è·ç¦»å°äºç­‰äºxçš„æ•°å¯¹çš„ä¸ªæ•°cnt
        int cnt = 0;
        for(int j = 0; j < nums.length; j ++) { // æšä¸¾æ¯ä¸€ä¸ªæ•°å¯¹çš„å³ç«¯ç‚¹j
            int l = 0, r = j; 
            while(l < r) { // åœ¨åŒºé—´[0, j]æ‰¾åˆ°ä¸€ä¸ªæœ€å°çš„midä½¿å¾—[mid,j]åŒºé—´çš„ä»»æ„ä¸‹æ ‡ä¸çš„æ•°å¯¹è·ç¦»éƒ½å°äºç­‰äºx
                int mid = l + r >> 1;
                if(nums[j] - nums[mid] <= x) r = mid;
                else l = mid + 1;
            }
            cnt += (j - l); // (j-l)è¡¨ç¤ºä»¥jä¸ºå³è¾¹ç•Œçš„æ•°å¯¹çš„ä¸ªæ•°(è¯¥æ•°å¯¹è·ç¦»å°äºç­‰äºx)
        }
        return cnt;
    }

    public int check(int[] nums, int mid) {
        return bsearch(nums, mid);
    }

    public int smallestDistancePair(int[] nums, int k) {
        Arrays.sort(nums); // ä»å°åˆ°å¤§æ’åº
        int n = nums.length;
        
        int l = 0, r = nums[n - 1] - nums[0]; // äºŒåˆ†åŒºé—´ï¼Œ[0,(max(nums)-min(nums))],ç¬¬kå°çš„æ•°å¯¹è·ç¦»ä¸€å®šåœ¨æ­¤åŒºé—´
        while(l < r) {
            int mid = l + r >> 1;
            if(check(nums, mid) >= k) r = mid;
            else l = mid + 1; 
        }

        return l;
    }
}
```

**æ–¹æ³•ä¸‰ï¼šæ’åº+äºŒåˆ†æŸ¥æ‰¾+åŒæŒ‡é’ˆ**

å¯¹äºå·²æ’åºçš„æ•°ç»„$nums$ï¼Œåˆå§‹åŒ–å·¦æŒ‡é’ˆ$i=0$ï¼Œä»å°åˆ°å¤§æšä¸¾æ‰€æœ‰æ•°å¯¹çš„å³ç«¯ç‚¹$j$ï¼Œç§»åŠ¨å·¦ç«¯ç‚¹ç›´åˆ°$nums[j]-[i]<=mid$ï¼Œé‚£ä¹ˆå³ç«¯ç‚¹ä¸º$j$ä¸”æ•°å¯¹çš„è·ç¦»å°äºç­‰äº$mid$çš„æ•°å¯¹ä¸ªæ•°$j-i$ï¼Œè®¡ç®—è¿™äº›æ•°ç›®ä¹‹å’Œã€‚

æ—¶é—´å¤æ‚åº¦åˆ†æï¼šæ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸º$O(nlogn)$ï¼Œè®¾$D=max(nums)-min(nums)$ï¼ŒäºŒåˆ†çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(logD)$ï¼ŒåŒæŒ‡é’ˆç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(n)$ã€‚æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(n(logn+logD))$

```java
class Solution {

    public int bpoint(int[] nums, int mid) {
        int cnt = 0;
        for(int i = 0, j = 0; j < nums.length; j ++ ) {
            while(nums[j] - nums[i] > mid) i ++ ;
            cnt += j - i; // åŠ ä¸ŠåŒºé—´[i,j]ä¸­æ‰€æœ‰ä»¥jä¸ºå³è¾¹ç•Œçš„æ•°å¯¹çš„ä¸ªæ•°
        }
            
        return cnt;
    }

    public int check(int[] nums, int mid) {
        return bpoint(nums, mid);
    }

    public int smallestDistancePair(int[] nums, int k) {
        Arrays.sort(nums); // ä»å°åˆ°å¤§æ’åº
        int n = nums.length;
        
        int l = 0, r = nums[n - 1] - nums[0]; // äºŒåˆ†åŒºé—´ï¼Œ[0,(max(nums)-min(nums))],ç¬¬kå°çš„æ•°å¯¹è·ç¦»ä¸€å®šåœ¨æ­¤åŒºé—´
        while(l < r) {
            int mid = l + r >> 1;
            if(check(nums, mid) >= k) r = mid;
            else l = mid + 1; 
        }

        return l;
    }
}
```



#### ï¼ˆ6ï¼‰2040. ä¸¤ä¸ªæœ‰åºæ•°ç»„çš„ç¬¬ K å°ä¹˜ç§¯ï¼ˆä¹˜æ³•ï¼Œæ•°æ®èŒƒå›´å¤§ï¼Œä¸é€‚ç”¨O(klogk)ç®—æ³•ï¼‰



#### ï¼ˆ7ï¼‰2386. æ‰¾å‡ºæ•°ç»„çš„ç¬¬ K å¤§å’Œï¼ˆå­åºåˆ—å’Œï¼Œé—®é¢˜è½¬æ¢ï¼Œå †ï¼‰

**é—®é¢˜**ï¼š

ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ª **æ­£** æ•´æ•° `k` ã€‚ä½ å¯ä»¥é€‰æ‹©æ•°ç»„çš„ä»»ä¸€ **å­åºåˆ—** å¹¶ä¸”å¯¹å…¶å…¨éƒ¨å…ƒç´ æ±‚å’Œã€‚

æ•°ç»„çš„ **ç¬¬ k å¤§å’Œ** å®šä¹‰ä¸ºï¼šå¯ä»¥è·å¾—çš„ç¬¬ `k` ä¸ª **æœ€å¤§** å­åºåˆ—å’Œï¼ˆå­åºåˆ—å’Œå…è®¸å‡ºç°é‡å¤ï¼‰

è¿”å›æ•°ç»„çš„ **ç¬¬ k å¤§å’Œ** ã€‚

å­åºåˆ—æ˜¯ä¸€ä¸ªå¯ä»¥ç”±å…¶ä»–æ•°ç»„åˆ é™¤æŸäº›æˆ–ä¸åˆ é™¤å…ƒç´ æ’ç”Ÿè€Œæ¥çš„æ•°ç»„ï¼Œä¸”æ´¾ç”Ÿè¿‡ç¨‹ä¸æ”¹å˜å‰©ä½™å…ƒç´ çš„é¡ºåºã€‚

**æ³¨æ„ï¼š**ç©ºå­åºåˆ—çš„å’Œè§†ä½œ `0` ã€‚

ä¾‹å­ï¼š

```java
è¾“å…¥ï¼šnums = [2,4,-2], k = 5
è¾“å‡ºï¼š2
è§£é‡Šï¼šæ‰€æœ‰å¯èƒ½è·å¾—çš„å­åºåˆ—å’Œåˆ—å‡ºå¦‚ä¸‹ï¼ŒæŒ‰é€’å‡é¡ºåºæ’åˆ—ï¼š
- 6ã€4ã€4ã€2ã€2ã€0ã€0ã€-2
æ•°ç»„çš„ç¬¬ 5 å¤§å’Œæ˜¯ 2 ã€‚
```

**æ•°æ®èŒƒå›´**ï¼š

- `n == nums.length`
- `1 <= n <= 10^5`
- `-10^9 <= nums[i] <= 10^9`
- `1 <= k <= min(2000, 2n)`

**æ€è·¯**ï¼š

æ­¤é¢˜çš„$n<=10^5$ï¼Œæ˜¾ç„¶æˆ‘ä»¬æ— æ³•æš´åŠ›ç©·ä¸¾æ‰€æœ‰çš„å­åºåˆ—ã€‚ä½†æ˜¯ï¼Œæ­¤é¢˜çš„$k<=2000$ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æ—¶é—´å¤æ‚åº¦ä¸º$O(k)$çš„ç®—æ³•ã€‚

**ä»ç®€åŒ–é—®é¢˜å¼€å§‹**  

é¦–å…ˆè€ƒè™‘æœ¬é¢˜çš„ç®€åŒ–é—®é¢˜ï¼Œç»™å®š$n$ä¸ª**éè´Ÿ**æ•°$a_1,a_2,...,a_n$ï¼Œæ±‚ç¬¬$k$ä¸ª**æœ€å°**å­åºåˆ—çš„å’Œã€‚

è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„é—®é¢˜ã€‚æˆ‘ä»¬å…ˆæŠŠæ‰€æœ‰æ•°**ä»å°åˆ°å¤§æ’åº**ï¼Œè®°$(s,i)$è¡¨ç¤ºä¸€ä¸ªæ€»å’Œä¸º$s$ï¼Œä¸”æœ€åä¸€ä¸ªå…ƒç´ æ˜¯ç¬¬$i$ä¸ªå…ƒç´ çš„å­åºåˆ—ã€‚

æˆ‘ä»¬ç”¨ä¸€ä¸ªå°æ ¹å †ç»´æŠ¤$(s,i)$ï¼Œä¸€å¼€å§‹å †ä¸­åªæœ‰ä¸€ä¸ªå…ƒç´ $(a_1,1)$ã€‚å½“æˆ‘ä»¬å–å‡ºå †é¡¶å…ƒç´ $(s,i)$æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š

- æŠŠ$a_{i+1}$æ¥åˆ°è¿™ä¸ªå­åºåˆ—çš„åé¢å½¢æˆæ–°çš„å­åºåˆ—ï¼Œä¹Ÿå°±æ˜¯å°†$(s+a_{i+1},i+1)$æ”¾å…¥å †ä¸­ã€‚
- æŠŠå­åºåˆ—ä¸­çš„$a_i$ç›´æ¥æ›¿æ¢æˆ$a_{i+1}$ï¼Œä¹Ÿå°±æ˜¯å°†$(s-a_i+a_{i+1},i+1)$æ”¾å…¥å †ä¸­ã€‚

ç¬¬$(k-1)$æ¬¡å–å‡ºçš„$(s,i)$ä¸­çš„$s$å°±æ˜¯ç­”æ¡ˆ($k=1$æ—¶ç­”æ¡ˆä¸ºç©ºé›†ä¹‹å’Œï¼Œä¹Ÿå°±æ˜¯0)ã€‚

è¿™ä¸ªåšæ³•çš„æ­£ç¡®æ€§åŸºäºä»¥ä¸‹äº‹å®ï¼š

- è¿™ç§æ–¹æ³•èƒ½**ä¸é‡ä¸æ¼**åœ°ç”Ÿæˆæ‰€æœ‰å­åºåˆ—ã€‚
- æ¯æ¬¡æ”¾è¿›å»çš„æ•°ä¸å°äºæ‹¿å‡ºæ¥çš„æ•°ã€‚

**æœ€å°å’Œå˜æœ€å¤§å’Œ**

å®é™…ä¸Šï¼Œæ±‚ç¬¬$k$ä¸ªæœ€å¤§çš„å­åºåˆ—å’Œï¼Œä¸æ±‚ç¬¬$k$ä¸ªæœ€å°çš„å­åºåˆ—å’Œæ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬æ±‚å‡º$k$å°å­åºåˆ—åå–åï¼ˆé€‰æ‹©ä¸åœ¨ç­”æ¡ˆä¸­çš„æ‰€æœ‰å…ƒç´ ä½œä¸ºæ–°çš„ç­”æ¡ˆï¼‰ï¼Œå°±èƒ½å¾—åˆ°$k$å¤§å­åºåˆ—ã€‚å› æ­¤ï¼Œæ‰€æœ‰å…ƒç´ ä¹‹å’Œå‡å»$k$å°å­åºåˆ—å’Œï¼Œå°±èƒ½å¾—åˆ°$k$å¤§å­åºåˆ—å’Œã€‚

**å¼•å…¥è´Ÿæ•°**

æ¥ä¸‹æ¥å›åˆ°åŸé—®é¢˜ï¼Œè€ƒè™‘**ç»™å®šçš„æ•°ä¸­æœ‰è´Ÿæ•°**çš„æƒ…å†µã€‚

é¦–å…ˆè®¡ç®— $m$è¡¨ç¤ºæ‰€æœ‰è´Ÿæ•°çš„å’Œï¼Œç„¶åå°†æ‰€æœ‰è´Ÿæ•°å˜æˆä»–ä»¬çš„ç»å¯¹å€¼ï¼ˆè¿™æ ·å°±å›åˆ°äº†å…¨æ˜¯éè´Ÿæ•°çš„æƒ…å†µï¼‰ã€‚ç­”æ¡ˆå°±æ˜¯$m$åŠ ä¸Š$k$å¤§å­åºåˆ—çš„å’Œã€‚

ä¸ºä»€ä¹ˆè¿™æ ·æ˜¯å¯¹çš„ï¼Ÿï¼ˆå®é™…ä¸Šï¼Œæ‰€æœ‰æ•°å–ç»å¯¹å€¼ä¹‹åï¼Œæ±‚ç¬¬$k$å¤§å­åºåˆ—çš„å’Œã€‚å¯¹æ‰€æœ‰çš„å­åºåˆ—å’Œå°†å»ä¸€ä¸ªæ•°$m$ï¼Œ**å…¶ç›¸å¯¹é¡ºåºæ˜¯ä¸å˜çš„**ã€‚å‡å»$m$å‰æ˜¯ç¬¬$k$å­åºåˆ—ï¼Œå‡å»$m$åä¾ç„¶æ˜¯ç¬¬$k$å¤§å­åºåˆ—ã€‚ï¼‰

è€ƒè™‘åˆ°ç”±æ­¤å¾—åˆ°çš„$k$å¤§å­åºåˆ—ï¼Œå®ƒå®é™…ä¸Šå”¯ä¸€å¯¹åº”äº†ä¸€ä¸ªåŸæœ‰çš„å­åºåˆ—ã€‚æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼š

- ä¸€å¼€å§‹ç»™å®šæ•´æ•° ${-3,-2,-1,4,5,6}$;
- ç»è¿‡è½¬æ¢ä¹‹åï¼Œæˆ‘ä»¬å¾—åˆ°$k$å¤§å­åºåˆ— ${2,1,5,6}$;
- å¯¹äºæ‰€æœ‰åœ¨è¯¥å­åºåˆ—ä¸­çš„éè´Ÿæ•°ï¼Œä»¤å®ƒæˆä¸ºç­”æ¡ˆçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´5å’Œ6æ˜¯ç­”æ¡ˆçš„ä¸€éƒ¨åˆ†ï¼›
- å¯¹äºæ‰€æœ‰ä¸åœ¨è¯¥å­åºåˆ—ä¸­çš„è´Ÿæ•°ï¼Œä»¤å®ƒæˆä¸ºç­”æ¡ˆçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´-3æ˜¯ç­”æ¡ˆçš„ä¸€éƒ¨åˆ†ï¼›
- æœ€åå¾—åˆ°çš„çœŸå®ç­”æ¡ˆ${-3,5,6}$ã€‚

æ—¶é—´å¤æ‚åº¦åˆ†æï¼Œæ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(nlogn)$ï¼Œkä¸ªæ•°å‡ºå…¥å †çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(klogk)$ï¼Œæ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(nlogn+klogk)$

```java
class Solution {
    public long kSum(int[] nums, int k) {
        int n = nums.length;

        long m = 0, sum = 0; // mè¡¨ç¤ºæ‰€æœ‰è´Ÿæ•°ä¹‹å’Œ,sumè¡¨ç¤ºæ‰€æœ‰æ•°çš„ç»å¯¹å€¼ä¹‹å’Œ
        for(int i = 0; i < n; i ++ ) { // å°†è´Ÿæ•°å–ç»å¯¹å€¼ 
            if(nums[i] < 0) {
                m += nums[i];
                nums[i] = -nums[i];
            }
            sum += nums[i];
        }

        Arrays.sort(nums); // ä»å°åˆ°å¤§æ’åº

        // å°æ ¹å †æ±‚ç»å¯¹å€¼æ•°ç»„kå°å­åºåˆ—ä¹‹å’Œ
        PriorityQueue<long[]> heap = new PriorityQueue<long[]>((a, b)-> (int)(a[0]-b[0]) );
        heap.offer(new long[]{nums[0], 0});

        long res = 0; // k = 1æ—¶è§†ä¸ºç©ºé›†ä¹‹å’Œï¼Œä¹Ÿå°±æ˜¯0
        for(int i = 0; i < k - 1; i ++ ) {
            long[] t = heap.poll();
            long s = t[0];
            int pos = (int)t[1];
            res = s;
            // ä¸¤ä¸ªæ“ä½œ
            if(pos + 1 < n) heap.offer(new long[]{s + nums[pos + 1], pos + 1});
            if(pos + 1 < n) heap.offer(new long[]{s - nums[pos] + nums[pos + 1], pos + 1});
        }

        // æœ€å°å’Œå˜æœ€å¤§å’Œ
        res = sum - res; // ç»å¯¹å€¼æ•°ç»„çš„kå¤§å­åºåˆ—ä¹‹å’Œ
        // å¼•å…¥è´Ÿæ•°
        return res + m;
    }
}
```



#### ï¼ˆ8ï¼‰[2583. äºŒå‰æ ‘ä¸­çš„ç¬¬ K å¤§å±‚å’Œ](https://leetcode.cn/problems/kth-largest-sum-in-a-binary-tree/)ï¼ˆåˆ†å±‚çš„å±‚åºéå†+å †ï¼‰

**é—®é¢˜**ï¼š

ç»™ä½ ä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ `root` å’Œä¸€ä¸ªæ­£æ•´æ•° `k` ã€‚

æ ‘ä¸­çš„ **å±‚å’Œ** æ˜¯æŒ‡ **åŒä¸€å±‚** ä¸ŠèŠ‚ç‚¹å€¼çš„æ€»å’Œã€‚

è¿”å›æ ‘ä¸­**ç¬¬ `k` å¤§çš„å±‚å’Œ**ï¼ˆä¸ä¸€å®šä¸åŒï¼‰ã€‚å¦‚æœæ ‘å°‘äº `k` å±‚ï¼Œåˆ™è¿”å› `-1` ã€‚

**æ³¨æ„**ï¼Œå¦‚æœä¸¤ä¸ªèŠ‚ç‚¹ä¸æ ¹èŠ‚ç‚¹çš„è·ç¦»ç›¸åŒï¼Œåˆ™è®¤ä¸ºå®ƒä»¬åœ¨åŒä¸€å±‚ã€‚

ä¾‹å­ï¼š

<img src="https://assets.leetcode.com/uploads/2022/12/14/binaryytreeedrawio-2.png" alt="img" style="zoom:80%;" />



```
è¾“å…¥ï¼šroot = [5,8,9,2,1,3,7,4,6], k = 2
è¾“å‡ºï¼š13
è§£é‡Šï¼šæ ‘ä¸­æ¯ä¸€å±‚çš„å±‚å’Œåˆ†åˆ«æ˜¯ï¼š
- Level 1: 5
- Level 2: 8 + 9 = 17
- Level 3: 2 + 1 + 3 + 7 = 13
- Level 4: 4 + 6 = 10
ç¬¬ 2 å¤§çš„å±‚å’Œç­‰äº 13 ã€‚
```

**æ•°æ®èŒƒå›´**ï¼š

- æ ‘ä¸­çš„èŠ‚ç‚¹æ•°ä¸º `n`
- `2 <= n <= 10^5`
- `1 <= Node.val <= 10^6`
- `1 <= k <= n`

æ€è·¯ï¼š

æ ‘çš„å±‚åºéå†+å¤§æ ¹å †ã€‚æ—¶é—´å¤æ‚åº¦ä¸º$O(nlogn)$ï¼Œå½“æ ‘çš„å½¢çŠ¶æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º$n$çš„å½“é“¾è¡¨æ—¶ï¼Œå¯ä»¥è¾¾åˆ°è¿™ä¸ªæœ€åçš„æ—¶é—´å¤æ‚åº¦ã€‚

```java
/**
 * Definition for a binary tree node.
 * public class TreeNode {
 *     int val;
 *     TreeNode left;
 *     TreeNode right;
 *     TreeNode() {}
 *     TreeNode(int val) { this.val = val; }
 *     TreeNode(int val, TreeNode left, TreeNode right) {
 *         this.val = val;
 *         this.left = left;
 *         this.right = right;
 *     }
 * }
 */
class Solution {

    public long bfs(TreeNode u, int k) {
        int hh = 0, tt = 0;
        TreeNode[] q = new TreeNode[100010];
        q[0] = u; // æ ¹èŠ‚ç‚¹å¦‚é˜Ÿåˆ—

        PriorityQueue<Long> heap = new PriorityQueue<Long>((a, b)-> -a.compareTo(b));
        while(hh <= tt) { // å½“tt < hhæ—¶, é˜Ÿåˆ—ä¸ºç©º
            int head = hh, tail = tt;
            long sum = 0; // è®°å½•å½“å‰å±‚æ‰€æœ‰å…ƒç´ ä¹‹å’Œ
            while(hh <= tail) { // éå†æ ‘çš„æ¯ä¸€å±‚èŠ‚ç‚¹
                TreeNode t = q[hh ++];
                sum += t.val;
                if(t.left != null) q[++ tt] = t.left;
                if(t.right != null) q[++ tt] = t.right;
            }
            heap.offer(sum);
        }
        if(heap.size() < k) return -1;
        while(-- k != 0) heap.poll();
        return heap.poll();
    }

    public long kthLargestLevelSum(TreeNode root, int k) {
        return bfs(root, k);
    }
}
```



#### ï¼ˆ9ï¼‰[1508. å­æ•°ç»„å’Œæ’åºåçš„åŒºé—´å’Œ](https://leetcode.cn/problems/range-sum-of-sorted-subarray-sums/) ï¼ˆå­åºåˆ—å’Œï¼ŒäºŒåˆ†åµŒå¥—åŒæŒ‡é’ˆ+å‰ç¼€å’Œï¼‰

**é—®é¢˜**ï¼š

ç»™ä½ ä¸€ä¸ªæ•°ç»„ `nums` ï¼Œå®ƒåŒ…å« `n` ä¸ªæ­£æ•´æ•°ã€‚ä½ éœ€è¦è®¡ç®—æ‰€æœ‰éç©ºè¿ç»­å­æ•°ç»„çš„å’Œï¼Œå¹¶å°†å®ƒä»¬æŒ‰å‡åºæ’åºï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„åŒ…å« `n * (n + 1) / 2` ä¸ªæ•°å­—çš„æ•°ç»„ã€‚

è¯·ä½ è¿”å›åœ¨æ–°æ•°ç»„ä¸­ä¸‹æ ‡ä¸º `left` åˆ° `right` **ï¼ˆä¸‹æ ‡ä» 1 å¼€å§‹ï¼‰**çš„æ‰€æœ‰æ•°å­—å’Œï¼ˆåŒ…æ‹¬å·¦å³ç«¯ç‚¹ï¼‰ã€‚ç”±äºç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œè¯·ä½ å°†å®ƒå¯¹ 10^9 + 7 å–æ¨¡åè¿”å›ã€‚

ä¾‹å­ï¼š

```
è¾“å…¥ï¼šnums = [1,2,3,4], n = 4, left = 1, right = 5
è¾“å‡ºï¼š13 
è§£é‡Šï¼šæ‰€æœ‰çš„å­æ•°ç»„å’Œä¸º 1, 3, 6, 10, 2, 5, 9, 3, 7, 4 ã€‚å°†å®ƒä»¬å‡åºæ’åºåï¼Œæˆ‘ä»¬å¾—åˆ°æ–°çš„æ•°ç»„ [1, 2, 3, 3, 4, 5, 6, 7, 9, 10] ã€‚ä¸‹æ ‡ä» le = 1 åˆ° ri = 5 çš„å’Œä¸º 1 + 2 + 3 + 3 + 4 = 13 ã€‚
```

**æ•°æ®èŒƒå›´**:

- `1 <= nums.length <= 10^3`
- `nums.length == n`
- `1 <= nums[i] <= 100`
- `1 <= left <= right <= n * (n + 1) / 2`

**æ€è·¯**ï¼šäºŒåˆ†+(åŒæŒ‡é’ˆ+å‰ç¼€å’Œ)+(åŒæŒ‡é’ˆ+å‰ç¼€å’Œçš„å‰ç¼€å’Œ)

å…·ä½“æ€è·¯ï¼š[å­æ•°ç»„å’Œæ’åºåçš„åŒºé—´å’Œ - å­æ•°ç»„å’Œæ’åºåçš„åŒºé—´å’Œ - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/range-sum-of-sorted-subarray-sums/solution/zi-shu-zu-he-pai-xu-hou-de-qu-jian-he-by-leetcode-/) 

- å°†æ‰€æœ‰çš„å­æ•°ç»„çš„å’Œä»å°åˆ°å¤§æ’åºï¼Œè®°å‰$left - 1$ä¸ªå­æ•°ç»„çš„å’Œä¸º $a$ï¼Œå‰$right$ä¸ªå­æ•°ç»„çš„å’Œä¸º$b$
- é‚£ä¹ˆä¸‹æ ‡ä¸º $left$ åˆ° $right$ ï¼ˆä¸‹æ ‡ä» 1 å¼€å§‹ï¼‰çš„æ‰€æœ‰æ•°å­—å’Œä¸º $b - a$. ï¼ˆæœ‰ç‚¹å‰ç¼€å’Œæ±‚åŒºé—´å’Œçš„æ€æƒ³åœ¨é‡Œé¢ï¼‰

è¦å®ç°æ­¤æ€è·¯ï¼Œéœ€è¦è§£å†³ä¸€ä¸‹å››ä¸ªå­é—®é¢˜ï¼š

**é—®é¢˜ä¸€**ï¼š**ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå¦‚ä½•è®¡ç®—è¯¥æ•°ç»„ä¸­ç¬¬kå°çš„å­æ•°ç»„çš„å’Œï¼Ÿ** ï¼ˆ**ç±»ä¼¼é¢˜ç›®ï¼š2386.æ‰¾å‡ºæ•°ç»„çš„ç¬¬Kå¤§å’Œ**ï¼‰

é‡‡ç”¨äºŒåˆ†æ¥å®ç°ï¼Œå…¶æ—¶é—´å¤æ‚åº¦æ˜¯$O(log(D)))$ ï¼Œå…¶ä¸­ $D=(sum(nums))$

- ç¡®å®šäºŒåˆ†åŒºé—´ï¼šè¯¥æ•°ç»„ä¸­ç¬¬ $k$ å°çš„å­æ•°ç»„çš„å’Œä¸€å®šä½äº$[0, sum(nums)]$ä¹‹é—´
- å¯¹äºäºŒåˆ†çš„ä¸­ç‚¹$mid$ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æ‰¾åˆ°å­æ•°ç»„å’Œå°äº$mid$çš„ä¸ªæ•°$cnt$
- å¦‚æœ $cnt >= k$, é‚£ä¹ˆ $r = mid$
- å¦‚æœ $cnt < k$, é‚£ä¹ˆ $l = mid + 1$

**é—®é¢˜äºŒ**ï¼š**å¯¹äºç»™å®šçš„æ•°ç»„ $nums$ï¼Œå¦‚ä½•å¿«é€Ÿç»Ÿè®¡å‡ºæœ‰å¤šå°‘ä¸ªå­æ•°ç»„çš„å’Œå°äºç­‰äº$mid$ï¼Ÿ**

é¢„å¤„ç†å‡ºå‰ç¼€å’Œæ•°ç»„ $s$ ï¼Œå¹¶é‡‡ç”¨åŒæŒ‡é’ˆæ¥æ±‚è§£ï¼Œå…¶æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n)$

å› ä¸ºè¦è®¡ç®—å­æ•°ç»„çš„å’Œï¼Œå°±ç­‰äºè¦è®¡ç®—åŒºé—´å’Œï¼Œå¯ä»¥äº†åˆ©ç”¨å‰ç¼€å’Œæ•°ç»„ï¼Œè®¡ç®—åŒºé—´å’Œçš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$

æ­¤é—®é¢˜å°±è½¬æ¢ä¸ºäº†ï¼Œå¯¹äºå‰ç¼€å’Œæ•°ç»„(æœ‰åº)ï¼Œæœ‰å¤šå°‘ä¸ªæ•°å¯¹çš„è·ç¦»å°äºç­‰äºmidï¼Ÿ(**ç±»ä¼¼é¢˜ç›®:719.æ‰¾å‡ºç¬¬kå°çš„è·ç¦»å¯¹**ï¼‰

åŒæŒ‡é’ˆç®—æ³•, è¯¥åŒæŒ‡é’ˆç®—æ³•å°è¯•å¯¹äºåŒºé—´$[i + 1, j]$, å¯¹äº**ä»»æ„ä»¥ä¸‹æ ‡$j$ç»“å°¾**çš„é•¿åº¦ä¸è¶…è¿‡$j - i$çš„å­æ•°ç»„, å…¶å…ƒç´ ä¹‹å’Œéƒ½ä¸è¶…è¿‡ç›®æ ‡å€¼$x$ã€‚

```java
int cnt = 0;
for(int i = 0; j = 0; j < s.length; j ++ ) // å‰ç¼€å’Œæ•°ç»„ä¸‹æ ‡æ˜¯ä»1å¼€å§‹ï¼Œä½†æ˜¯è¿™é‡Œæšä¸¾éœ€è¦ä»0å¼€å§‹
    while(s[j] - s[i] > mid) i ++ ; // å› ä¸ºå­æ•°ç»„çš„å…ƒç´ ä¸ªæ•°ä¹Ÿå¯ä»¥æ˜¯1
    cnt += j - i;
```

åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å‡ºåŸæ•°ç»„ä¸­ç¬¬kå°çš„å­æ•°ç»„å’Œæ˜¯å¤šå°‘äº†

**é—®é¢˜ä¸‰**ï¼š**å·²çŸ¥ç¬¬$k$ä¸ªå­æ•°ç»„çš„å’Œæ˜¯ $x$, æˆ‘ä»¬å¦‚ä½•å¿«é€Ÿè®¡ç®—å‰$k$ä¸ªå­æ•°ç»„çš„å’Œ$sum$ï¼Œä»¥åŠå®ƒä»¬çš„ä¸ªæ•°$count$ï¼Ÿ**

æ­¤é—®é¢˜å¯ä»¥è½¬æ¢ä¸ºï¼Œå·²çŸ¥å‰ç¼€å’Œæ•°ç»„ï¼Œè®¡ç®—æœ‰å¤šå°‘ä¸ªæ•°å¯¹çš„è·ç¦»å°äºç­‰äº $x$, è®¡ç®—å…¶ä¸ªæ•°$count$å’Œè·ç¦»ä¹‹å’Œ$sum$ï¼Ÿ

åŒæŒ‡é’ˆç®—æ³•ï¼Œè¯¥åŒæŒ‡é’ˆç®—æ³•å°è¯•æšä¸¾å¯¹äºåŒºé—´$[i + 1, j]$, å¯¹äº**ä»»æ„ä»ä¸‹æ ‡$i+1$å¼€å§‹**é•¿åº¦ä¸è¶…è¿‡$j - i$çš„å­æ•°ç»„, å…¶å…ƒç´ ä¹‹å’Œéƒ½ä¸è¶…è¿‡ç›®æ ‡å€¼$x$ã€‚

```java
int cnt = 0, sum = 0;
for(int i = 0; j = 1; i < s.length; i ++ ) // å‰ç¼€å’Œæ•°ç»„ä¸‹æ ‡æ˜¯ä»1å¼€å§‹ï¼Œä½†æ˜¯è¿™é‡Œæšä¸¾éœ€è¦ä»0å¼€å§‹
    while(j < s.length && s[j] - s[i] < x) j ++ ; // ç¬¬ä¸€æ­¥è®¡ç®—æ‰€æœ‰ä¸¥æ ¼å°äºxçš„å­æ•°ç»„çš„å’Œçš„ä¸ªæ•°ä»¥åŠå®ƒä»¬çš„å’Œ
    j --;
		cnt += j - i;
    // å¦‚ä½•å¿«é€Ÿè®¡ç®—åŒºé—´[i,j]ä¸­æ‰€æœ‰ä»¥iä¸ºå·¦ç«¯ç‚¹çš„å­æ•°ç»„å’Œçš„ä¹‹å’Œï¼Ÿè¦O(1)è€Œä¸æ˜¯O(n)
    // s[j] - s[i] è¡¨ç¤ºåŒºé—´[i,j]ä¸­æ‰€æœ‰å…ƒç´ ä¹‹å’Œ
    // sum(s[t] - s[i]), t = i, ..., j
    // <=> (s[i + 1] - s[i]) + (s[i + 2] - s[i]) + ... + (s[j] - s[i])
    // <=> (s[i + 1] + s[i + 2] + ... + s[j]) - s[i] * (j - i)
    // <=> (sp[j] - sp[i]) - s[i] * (j - i) // spæ˜¯å‰ç¼€å’Œçš„åŒºé—´å’Œ
    sum += (sp[j] - sp[i]) - s[i] * (j - i);
sum = (sum + x * (k - cnt)) % MOD;
```

**é—®é¢˜å››**: **å·²çŸ¥å‰$left-1$ä¸ªå­æ•°ç»„çš„å’Œä¸º$a$ï¼Œå‰$right$ä¸ªå­æ•°ç»„çš„å’Œä¸º$b$ï¼Œè®¡ç®—ä¸‹æ ‡ä¸º$left$åˆ°$right$(ä¸‹æ ‡ä»1å¼€å§‹)çš„æ‰€æœ‰æ•°å­—å’Œ**

å‰ç¼€å’Œæ±‚åŒºé—´å’Œçš„æ€æƒ³: $b - a$

```java
class Solution {
    final int MOD = (int)1e9 + 7; // 1000000007

    public int rangeSum(int[] nums, int n, int left, int right) {
        int[] s = new int[n + 1];
        int[] sp = new int[n + 1];
        for(int i = 1; i <= n; i ++ ) {
            s[i] = s[i - 1] + nums[i - 1];
            sp[i] = (sp[i - 1] + s[i]);
        }
        return getsum(s, sp, right) - getsum(s, sp, left - 1);
    }

    public int getsum(int[] s, int[] sp, int k) {
        int x = findk(s, k);
        int cnt = 0, sum = 0;
        for(int i = 0, j = 1; i < s.length; i ++ ) { // ç¬¬ä¸€æ­¥è®¡ç®—æ‰€æœ‰ä¸¥æ ¼å°äºxçš„å­æ•°ç»„çš„å’Œçš„ä¸ªæ•°ä»¥åŠå®ƒä»¬çš„å’Œ
            while(j < s.length && s[j] - s[i] < x) j ++ ;
            j --;
            cnt += (j - i);
          	// å¯¹äºåŒºé—´[i + 1, j], å¯¹äºä»»æ„ä»ä¸‹æ ‡i+1å¼€å§‹é•¿åº¦ä¸è¶…è¿‡(j - i)çš„å­æ•°ç»„, å…¶å…ƒç´ ä¹‹å’Œéƒ½ä¸è¶…è¿‡ç›®æ ‡å€¼x
            sum = (sum + sp[j] - sp[i] - s[i] * (j - i)) % MOD;
        }
        sum = (sum + x * (k - cnt)) % MOD; // ç¬¬äºŒæ­¥è®¡ç®—æ‰€æœ‰ä¸¥æ ¼ç­‰äºxçš„å­æ•°ç»„çš„å’Œçš„ä¸ªæ•°ä»¥åŠå®ƒä»¬çš„å’Œ
        return sum;
    }

    public int findk(int[] s, int k) { // ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå¦‚ä½•è®¡ç®—è¯¥æ•°ç»„ä¸­ç¬¬kå°çš„å­æ•°ç»„çš„å’Œï¼Ÿ
        int l = 0, r = s[s.length - 1]; 
        while(l < r) {
            int mid = (l + r) >> 1;
            if(check(s, mid) >= k) r = mid;
            else l = mid + 1;
        }
        return l;
    }

    public int check(int[] s, int x) { // è®¡ç®— å¯¹äºç»™å®šçš„æ•°ç»„ numsï¼Œå¦‚ä½•å¿«é€Ÿç»Ÿè®¡å‡ºæœ‰å¤šå°‘ä¸ªå­æ•°ç»„çš„å’Œå°äºç­‰äºxï¼Ÿ
        int cnt = 0;
        for(int i = 0, j = 0; j < s.length; j ++ ) {
            while(i < s.length && s[j] - s[i] > x) i ++ ;
          	// å¯¹äºåŒºé—´[i + 1, j], å¯¹äºä»»æ„ä»¥ä¸‹æ ‡jç»“å°¾çš„é•¿åº¦ä¸è¶…è¿‡(j - i)çš„å­æ•°ç»„, å…¶å…ƒç´ ä¹‹å’Œéƒ½ä¸è¶…è¿‡ç›®æ ‡å€¼x
            if (i < s.length) cnt += (j - i);
        }
        return cnt;
    }
}
```













[1982. ä»å­é›†çš„å’Œè¿˜åŸæ•°ç»„](https://leetcode.cn/problems/find-array-given-subset-sums/)



[1675. æ•°ç»„çš„æœ€å°åç§»é‡](https://leetcode-cn.com/problems/minimize-deviation-in-array/)



[6455. ä½¿æ‰€æœ‰å­—ç¬¦ç›¸ç­‰çš„æœ€å°æˆæœ¬](https://leetcode.cn/problems/minimum-cost-to-make-all-characters-equal/)

6456. çŸ©é˜µä¸­ä¸¥æ ¼é€’å¢çš„å•å…ƒæ ¼æ•°

[6394. å­—ç¬¦ä¸²ä¸­çš„é¢å¤–å­—ç¬¦](https://leetcode.cn/problems/extra-characters-in-a-string/)







### :mag_right: å‚è€ƒæ–‡çŒ® 

[1] https://leetcode.cn/

[2] https://www.acwing.com/

### :closed_lock_with_key: License

æœ¬æ–‡å†…å®¹ä¸æ˜¯å°†ç½‘ä¸Šçš„èµ„æ–™éšæ„æ‹¼å‡‘è€Œæ¥ï¼Œé™¤äº†å°‘éƒ¨åˆ†å¼•ç”¨ä¹¦ä¸Šå’ŒæŠ€æœ¯æ–‡æ¡£çš„åŸæ–‡ï¼ˆè¿™éƒ¨åˆ†å†…å®¹éƒ½åœ¨æœ«å°¾çš„å‚è€ƒæ–‡çŒ®ä¸­åŠ äº†å‡ºå¤„ï¼‰ï¼Œå…¶ä½™éƒ½æ˜¯ä½œè€…çš„åŸåˆ›ã€‚åœ¨æ‚¨å¼•ç”¨æœ¬æ–‡å†…å®¹æˆ–è€…å¯¹å†…å®¹è¿›è¡Œä¿®æ”¹æ¼”ç»æ—¶ï¼Œè¯·ç½²åå¹¶ä»¥ç›¸åŒæ–¹å¼å…±äº«ï¼Œè°¢è°¢ã€‚

è½¬è½½æ–‡ç« è¯·åœ¨å¼€å¤´æ˜æ˜¾å¤„æ ‡æ˜è¯¥é¡µé¢åœ°å€ï¼Œå…¬ä¼—å·ç­‰å…¶å®ƒè½¬è½½è¯·è”ç³» [1246550576@qq.com](mailto:1246550576@qq.com)

### ğŸ“æ’ç‰ˆç”³æ˜

ç¬”è®°å†…å®¹æŒ‰ç…§ä¸€å®šæ ‡å‡†è¿›è¡Œæ’ç‰ˆï¼Œä»¥ä¿è¯å†…å®¹çš„å¯è¯»æ€§ã€‚

ä¸ä½¿ç”¨ `![]()` è¿™ç§æ–¹å¼æ¥å¼•ç”¨å›¾ç‰‡ï¼Œè€Œæ˜¯ç”¨ `<img>` æ ‡ç­¾ã€‚ä¸ºäº†èƒ½å¤Ÿæ§åˆ¶å›¾ç‰‡ä»¥åˆé€‚çš„å¤§å°æ˜¾ç¤ºï¼Œä½¿ç”¨ `<div align="center"> <img src=""/> </div>` è¾¾åˆ°å±…ä¸­çš„æ•ˆæœã€‚

æ’ç‰ˆç¾åŒ–å·¥å…·ï¼š[Typora-Purple](https://theme.typora.io/theme/Purple/)

